/*
 * L3_MODE.c
 *
 *  Created on: 2023/11/11
 *      Author: ratta
 */

/*
 * L2_UI.c
 *
 *  Created on: 2023/11/10
 *      Author: ratta
 */

/***************************************************************************************************************
 * 利用ファイルのヘッダ
 **************************************************************************************************************/
#include "r_smc_entry.h"
#include "L1_AD.h"
#include "L2_UI.h"
#include "L2_SENSOR.h"
#include "L2_INIT.h"

/***************************************************************************************************************
 * 自ファイルのヘッダ
 **************************************************************************************************************/

/***************************************************************************************************************
 * 変数
 **************************************************************************************************************/

/***************************************************************************************************************
 * 公開変数
 **************************************************************************************************************/

/***************************************************************************************************************
 * 公開関数
 **************************************************************************************************************/
char mode(void){
	static char print_str[80];
	_sensor get;
	char mode_count=0;
	char num;
	do{
		num=previous_value.distance[1]*10;
		ui_num(num);
		R_BSP_SoftwareDelay(10,BSP_DELAY_MILLISECS );
		ui_off();
		sprintf(print_str, "\r%f=%f=%f=%d\r\n",previous_value.distance[0],previous_value.distance[1],get.goal,mode_count);
		R_DMAC1_AsyncTransmit((uint8_t *) print_str, (uint16_t) strlen(print_str));
		get=sensor_callibration(&raw);
		if(get.goal >=0.1){
			R_BSP_SoftwareDelay(10,BSP_DELAY_MILLISECS );
			if(get.goal <0.4)mode_count++;
		}
	}while(mode_count<1);
	num=previous_value.distance[1]*10;
	sprintf(print_str, "\r%d\r\n",num);
	R_DMAC1_AsyncTransmit((uint8_t *) print_str, (uint16_t) strlen(print_str));
	for(char i=0;i<5;i++){
		ui_num(num);
		R_BSP_SoftwareDelay(100,BSP_DELAY_MILLISECS );
		ui_off();
	}
	return num;
}
/***************************************************************************************************************
 * 非公開関数
 **************************************************************************************************************/







